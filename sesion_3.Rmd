---
title: "Capacitaci√≥n en R y herramientas de productividad"
subtitle: "Sesi√≥n 3"
author: 
date: '`r Sys.Date()`'
output:
  xaringan::moon_reader:
    seal: false
    #lib_dir: libs
    css: xaringan-themer.css
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: False
---

class: center, middle

.linea-superior[]
.linea-inferior[]

<img src="imagenes/logo_portada2.png" width="200" />

## Capacitaci√≥n en R y herramientas de productividad

## Proyecto Estrat√©gico Servicios Compartidos para la Producci√≥n Estad√≠stica

## Procesamiento de bases de datos (2)

### Mayo 2021

```{r setup, include=FALSE}
options(htmltools.dir.version = TRUE)
knitr::opts_chunk$set(message = FALSE) 
```

```{r xaringan-themer, include=FALSE, warning=FALSE}
library(xaringanthemer)
```

---

background-image: url("imagenes/fondo2.PNG")
background-size: contain;
background-position: 100% 0%

# Contenidos de hoy

Durante esta jornada continuaremos viendo funciones para la manipulaci√≥n 
dataframes.

--

- Uso de funciones condicionales en la edici√≥n de datos (`if_else()`, 
`case_when()`).

--

- Funciones de agrupaci√≥n (`group_by()`, `summarise()`).

--

- Tidy data (`pivot_longer()`, `pivot_wider()`).

---

background-image: url("imagenes/fondo2.PNG")
background-size: contain;
background-position: 100% 0%

# Breve resumen

En la sesi√≥n anterior vimos lo siguiente:

--

- C√≥mo importar dataframes de R, usando la funci√≥n `load()`, y desde otras 
fuentes usando paquetes como: **`haven`**, **`readr`** y **`readxl`**.

--

- C√≥mo seleccionar variables dentro de un dataframe usando `select()`.

--

- C√≥mo renombrar variables dentro de un dataframe, utilizando `rename()`.

--

- C√≥mo filtrar variables de una dataframe, utilizando `filter()`. 

--

- C√≥mo ordenar las filas de un dataframe usando `arrange()`.

--

- C√≥mo editar y/o crear variables utilizando `mutate()`.

---

background-image: url("imagenes/fondo2.PNG")
background-size: contain;
background-position: 100% 0%

# Breve resumen

Vimos que todas estas funciones para manipulaci√≥n de dataframes siguen una 
estructura similar. 

--

Cada una se comporta como un *verbo* y es posible 
conectar estas acciones con un operador llamado "**pipe**" (**%>%**).

--

Tambi√©n vimos que los pipes funcionan de la siguiente manera:

--

    1) Se selecciona un dataframe sobre el que se trabajar√°.
    
--

    2) Se ejecuta una acci√≥n sobre ese dataframe.
    
--

    3) Se obtiene un dataframe como resultado de la aplicaci√≥n de la acci√≥n.



---

background-image: url("imagenes/fondo2.PNG")
background-size: contain;
background-position: 100% 0%

# Breve resumen

Un ejemplo: utilizando el siguiente dataframe...

```{r, warning=FALSE}
df <- data.frame(x1 = c(1, 2, 3, 4),
                 x2 = c("perro", "gato", "caballo", "conejo"))
print(df[1:2, ])
```

--

... crear una columna con el n√∫mero de caracteres que tiene x2

...filtrar aquellos registros con m√°s de 5 caracteres

...luego ordenar de manera descendente, seg√∫n el n√∫mero de caracteres

--

```{r}
library(dplyr)
df %>%
  mutate(n = nchar(x2)) %>% # nchar(), funci√≥n utilizada para contar caracteres
  filter(n > 5) %>%
  arrange(desc(n))
```

---

background-image: url("imagenes/transformer.gif")
background-size: cover
class: center, bottom, inverse

# Transformaci√≥n de datos (2)

---

background-image: url("imagenes/fondo2.PNG")
background-size: contain;
background-position: 100% 0%
  
# Uso de condicionales: if_else()
  
En la sesi√≥n anterior, conocimos la funci√≥n `if_else()`, la cual se puede 
entender como: "*si sucede..., haz..., de otro modo, haz...*".

--

La funci√≥n `if_else()`, considera un argumento espec√≠fico para aquellas 
condiciones que no es posible evaluar si son *verdaderas* o *falsas* 
(valores missing).

--

```{r, warning=FALSE}
library(readr)
ene <- read_csv(file = "data/ene-2019-11.csv")
```

```{r, echo=FALSE}
ene <- ene %>%
  mutate(sexo_missing = if_else(row_number() <= 10, NA_real_, sexo))

```


```{r}
ene <- ene %>%
  mutate(glosa_sexo = if_else(sexo_missing == 1, "hombre", "mujer", "missing"))
table(ene$glosa_sexo)
```


---

background-image: url("imagenes/fondo2.PNG")
background-size: contain;
background-position: 100% 0%
  
# Uso de condicionales: if_else()
  

¬øPodr√≠amos usar `if_else()` para crear variables con m√°s categor√≠as?

--

Pensemos en 10 tramos de edad...


.center[
<img src="https://media.giphy.com/media/26gR0YFZxWbnUPtMA/giphy.gif" width="400" />
]


--

## Podemos usar varios `if_else()` consecutivamente


---

background-image: url("imagenes/fondo2.PNG")
background-size: contain;
background-position: 100% 0%
  
# Uso de condicionales: if_else()
  
Ejemplo: creaci√≥n de tres tramos etarios: "menores a 15", "entre 15 y 30 a√±os" 
y "mayores de 30 a√±os".

--

```{r}
# Ejemplo: if_else consecutivos
ene <- ene %>%
  mutate(
    tramos_etarios = if_else(edad < 15,
                             "menores a 15",
                             ""),
    tramos_etarios = if_else(edad >= 15 & edad <= 30,
                             "entre 15 y 30 a√±os",
                             tramos_etarios),
    tramos_etarios = if_else(edad > 30,
                             "mayores de 30 a√±os",
                             tramos_etarios)
    )
```

--

```{r}
table(ene$tramos_etarios, useNA = "always")
```

---

background-image: url("imagenes/fondo2.PNG")
background-size: contain;
background-position: 100% 0%
  
# Uso de condicionales: if_else()
  
En cada paso, es necesario utilizar el valor previo

--

Si no se considera lo anterior, la variable creada no tendr√° "historia".

--

### ¬øQu√© pasa si tenemos muchas categor√≠as?

### ¬øPodemos hacerlo mejor?

.center[
<img src="https://media.giphy.com/media/xUPGcz2H1TXdCz4suY/giphy.gif" width="400" />
]



---

background-image: url("imagenes/fondo2.PNG")
background-size: contain;
background-position: 100% 0%
  
# Uso de condicionales: case_when()
  
Usando `case_when()`, el resultado anterior ser√≠a:

```{r}
# Ejemplo: m√©todo 2
ene <- ene %>%
  mutate(tramos_etarios3 = case_when(edad < 15               ~ "menores a 15",
                                     edad >= 15 & edad <= 30 ~ "entre 15 y 30 a√±os",
                                     edad > 30               ~ "mayores de 30 a√±os",
                                     TRUE                    ~ "fuera de rango")
    )
```

--

```{r}
table(ene$tramos_etarios3, useNA = "always")
```

---

background-image: url("imagenes/fondo2.PNG")
background-size: contain;
background-position: 100% 0%
  
# Uso de condicionales: case_when()
  
La funci√≥n `case_when()` funciona de la siguiente manera:

--

```{r, eval=F}
dataframe %>%
  mutate(nv = case_when(cond_1 ~ valor_1,
                        cond_2 ~ valor_2))
```

--

Si la **primera condici√≥n es verdadera**, no se eval√∫a nada m√°s

--

Si la **primera condici√≥n es falsa**, se eval√∫a la segunda

--

Si ninguna de las condiciones es verdadera, se asigna NA

---

background-image: url("imagenes/fondo2.PNG")
background-size: contain;
background-position: 100% 0%
  
# Uso de condicionales: case_when()

**IMPORTANTE**: 

--

- La *virgulilla* (~) tiene que ser utilizada entre la condici√≥n 
y el valor a asignar.

--

- El orden en el que programan las condiciones es importante.

    - Si la primera condici√≥n es verdadera, se asignar√° el primer valor y no 
    se evaluar√°n las siguientes condiciones.
    
--

- Los valores a asignar deben ser del mismo tipo

---

background-image: url("imagenes/fondo2.PNG")
background-size: contain;
background-position: 100% 0%
  
# Peque√±o ejercicio
  
Utilizando la base de la ene y usando `case_when`, genera: 

- **tramos1**: valor 1 si la edad es mayor o igual a 0 y menor que 15, el valor 2 si 
la edad es mayor o igual a 15 y menor que 30, el valor 3 si la edad es mayor o igual a 30 y menor a 60 y 
el valor 4 si la edad es mayor o igual que 60.

Recuerda incluir una condici√≥n para los valores que puedan estar fuera del rango establecido y usa alg√∫n c√≥digo distintivo para eso.

Luego, utilizando la funci√≥n `table()`, observa cu√°ntos registros est√°n 
codificados por categor√≠a para la variable "tramos1".



---

background-image: url("imagenes/fondo2.PNG")
background-size: contain;
background-position: 100% 0%
  
# Peque√±o ejercicio
  
```{r}
ene <- ene %>%
  mutate(tramos1 = case_when(edad >= 0  & edad < 15 ~ 1,
                             edad >= 15 & edad < 30 ~ 2,
                             edad >= 30 & edad < 60 ~ 3,
                             edad >= 60             ~ 4,
                             TRUE                   ~ 999))
    
```

--

```{r}
table(ene$tramos1, useNA = "always")
```


--

**¬øQu√© pasa si la √∫ltima condici√≥n se reemplaza por <= 200?**


```{r, eval=FALSE}

ene <- ene %>%
  mutate(tramos1 = case_when(edad >= 0  & edad < 15 ~ 1,
                             edad >= 15 & edad < 30 ~ 2,
                             edad >= 30 & edad < 60 ~ 3,
                             edad >= 60             ~ 4,
                             edad <= 200            ~ 5, #<< 
                             TRUE                   ~ 999))

```


---

background-image: url("imagenes/group_by_ungroup.png")
background-size: 100% 100%
class: center, bottom, inverse

# <font color = "blue">Agrupaci√≥n de unidades</font>

---

background-image: url("imagenes/fondo2.PNG")
background-size: contain;
background-position: 100% 0%

# Agrupaci√≥n de unidades

En la sesi√≥n anterior, vimos algunas funciones que se pueden utilizar en 
conjunto con `mutate()`:

--

- **min()**, **max()**: funciones que nos entregan los valores m√≠nimos y 
m√°ximos de una variable.

- **mean()**: funci√≥n que nos entrega el promedio de los valores de una 
variable.

- **sum()**: funci√≥n que nos entrega la suma de los valores de una variable.

- **n()**: funci√≥n que nos entrega el n√∫mero de registros de una variable.

--

¬øQu√© podr√≠amos hacer si queremos obtener la edad media de las mujeres?


.center[
<img src="https://media.giphy.com/media/xUPGcz2H1TXdCz4suY/giphy.gif" width="200" />
]


---

background-image: url("imagenes/fondo2.PNG")
background-size: contain;
background-position: 100% 0%

# Agrupaci√≥n de unidades

Podr√≠amos usar la funci√≥n `filter()` y luego la funci√≥n `mean()`

```{r, eval=FALSE}
ene <- ene %>% 
  filter(sexo == 1) %>% 
  mutate(media = mean(edad))

```


--

El paquete **`dplyr`** incluye una funci√≥n llamada `group_by()`, la cual 
agrupa los registros seg√∫n los valores de una o m√°s variables.

--

Esta agrupaci√≥n nos permite aplicar la misma funci√≥n a todos los subconjuntos 
como si fuesen distintos dataframes.

---

background-image: url("imagenes/fondo2.PNG")
background-size: contain;
background-position: 100% 0%

# Agrupaci√≥n de unidades

Gran parte del an√°lisis de datos involucra la aplicaci√≥n de una 
estrategia que en ingl√©s se denomina *split-apply-combine*.

--
.small[
```{r}
ene <- ene %>%
  group_by(sexo) %>%
  mutate(n_sexo = n())
```
]

- Primero `group_by()` divide el *data frame*.

- Luego opera una funci√≥n con los datos fragmentados.

- Finalmente, volvemos a combinar los resultados parciales.

--

.center[

<img src="imagenes/split_apply_combine.png" width="600" />

]


---

background-image: url("imagenes/fondo2.PNG")
background-size: contain;
background-position: 100% 0%

# Agrupaci√≥n de unidades

N√∫mero de hombres

.small[
```{r}
ene %>%
  filter(sexo == 1) %>% 
  select(sexo, n_sexo) %>% 
  slice(1:2)
```
]
--

N√∫mero de mujeres

.small[
```{r}
ene %>% 
  filter(sexo == 2) %>%
  select(sexo, n_sexo) %>% 
  slice(1:2)
```
]
---

background-image: url("imagenes/fondo2.PNG")
background-size: contain;
background-position: 100% 0%

# Par√©ntesis de slice

- Funci√≥n auxiliar **`slice()`**

--

Como su nombre lo dice, esta funci√≥n nos permite "cortar una rebanada" de un 
dataframe, es decir, extraer una porci√≥n de registros.

--

Se puede extraer un registro o un conjunto de registros.

--

Esta funci√≥n se puede combinar con `group_by()`, y extraer un (o un conjunto) 
registro de cada grupo.



---

background-image: url("imagenes/fondo2.PNG")
background-size: contain;
background-position: 100% 0%

# Agrupaci√≥n de unidades

Retomemos nuestro trabajo con `guaguas`

--

Utilizando la base de guaguas, obtener el nombre m√°s utilizado en Chile en 
todos los tiempos

--


```{r, eval=FALSE}
library(guaguas)
guaguas %>%
  group_by(nombre) %>%
  mutate(total = sum(n)) %>%
  arrange(desc(total)) %>% 
  slice(1) #<<

```

- agrupar

- sumar las apariciones de cada nombre

- ordenar de mayor a menor

- cortar la primera fila

---
background-image: url("imagenes/fondo2.PNG")
background-size: contain;
background-position: 100% 0%

# Agrupaci√≥n de unidades


```{r, echo=FALSE}
library(guaguas)
guaguas %>%
  group_by(nombre) %>%
  mutate(total = sum(n)) %>%
  arrange(desc(total)) %>% 
  slice(1)

```



.center[
<img src="https://media.giphy.com/media/xUPGcz2H1TXdCz4suY/giphy.gif" width="200" />
]

---

background-image: url("imagenes/fondo2.PNG")
background-size: contain;
background-position: 100% 0%

# Agrupaci√≥n de unidades

`group_by` sigue operando, hasta que se indique lo contrario 


```{r, eval=F}
guaguas %>%
  group_by(nombre) %>%
  mutate(total = sum(n)) %>% #<<
  arrange(desc(total)) %>% #<<
  slice(1) #<<

```


--

Si queremos realizar una operaci√≥n no agrupada, luego de haber usado `group_by`,
debemos desagrupar con `ungroup`


---

background-image: url("imagenes/fondo2.PNG")
background-size: contain;
background-position: 100% 0%

# Agrupaci√≥n de unidades

```{r}
guaguas %>%
  group_by(nombre) %>%
  mutate(total = sum(n)) %>%
  ungroup() %>%  #<<
  arrange(desc(total)) %>% 
  select(nombre, total) %>% 
  slice(1)


```

Ahora sabemos que el nombre m√°s com√∫n desde que se tiene registros es Mar√≠a  ü§ìü§ìü§ìüòÑ


---

background-image: url("imagenes/fondo2.PNG")
background-size: contain;
background-position: 100% 0%

# Ejercicio express

Utilizando la base de la ENE, creemos una columna llamada **media_edad** que contenga la media de edad en cada una de las regiones

--

```{r}
ene <- ene %>% 
  group_by(region) %>% 
  mutate(media_edad = mean(edad))
```



---

background-image: url("imagenes/fondo2.PNG")
background-size: contain;
background-position: 100% 0%

# Uso de summarise()


Un aliado natural de `group_by()` es `summarise()`.

--

Esta funci√≥n permite resumir variables existentes en un dataframe.

--

En combinaci√≥n con otras funciones, es una manera de tabular informaci√≥n.

--

.center[
<img src="imagenes/group.png" width="400" />
]



---

background-image: url("imagenes/fondo2.PNG")
background-size: contain;
background-position: 100% 0%

# Uso de summarise()

Con la combinaci√≥n de estas dos funciones podemos obtener un "cuadro de 
resumen".

--

Un ejemplo:

--

- Obtener el n√∫mero de registros por regi√≥n.

- Obtener el promedio de edad por regi√≥n.

- Obtener la mediana de edad por regi√≥n

---

background-image: url("imagenes/fondo2.PNG")
background-size: contain;
background-position: 100% 0%

# Uso de summarise()

```{r}
ene %>%
  group_by(region) %>%
  summarise(n = n(), promedio = mean(edad), mediana = median(edad))
```

---

background-image: url("imagenes/fondo2.PNG")
background-size: contain;
background-position: 100% 0%

# Ejercicio express

Construir un cuadro de resumen que incluya lo siguiente:

- N√∫mero de registros de la regi√≥n de O'Higgins, por grupo ocupacional (b1).

--

```{r}
ene %>%
  filter(region == 6) %>%
  group_by(b1) %>%
  summarise(n = n())
```

---

background-image: url("https://www.openscapes.org/img/blog/tidydata/tidydata_1.jpg")
background-size: 100% 100%
class: center, bottom, inverse

---

background-image: url("imagenes/fondo2.PNG")
background-size: contain;
background-position: 100% 0%

# Tidy data

Es una forma de describir datos que est√°n organizados con una **estructura rectangular**.

--

Es importante tener en consideraci√≥n tres principios:

--

- Cada columna es una variable.

--

- Cada fila es una observaci√≥n.

--

- Cada celda es un valor, o sea, la intersecci√≥n entre una fila y una columna, 
entre variable y observaci√≥n.

---

background-image: url("https://www.openscapes.org/img/blog/tidydata/tidydata_2.jpg")
background-size: 100% 100%
class: center, bottom, inverse

---

background-image: url("imagenes/fondo2.PNG")
background-size: contain;
background-position: 100% 0%

# Tidy data

Algunas caracter√≠sticas de estas datas son:

- M√°s eficiente para la ciencia de datos.

- Facilitan la colaboraci√≥n.

- Mejoran la reproducibilidad.

--

El universo de **`tidyverse`** cuenta con un paquete llamado **`tidyr`**,  
que contiene funciones para implementar los conceptos de **tidy data**.

--

.center[
<img src="imagenes/tidyr.png" width="200" />
]

---

background-image: url("imagenes/fondo2.PNG")
background-size: contain;
background-position: 100% 0%

# Tidy data

.pull-left[


En esta sesi√≥n veremos dos funciones del paquete **tidyr**:

- **`pivot_wider()`**

Equivale a transponer un dataframe a formato horizontal.

- **`pivot_longer()`**

Equivale a transponer un dataframe a formato vertical.

]

.pull-right[

<img src="imagenes/wide-long.png" width="250" />

]

---

background-image: url("imagenes/fondo2.PNG")
background-size: contain;
background-position: 100% 0%

# Tidy data

## Funci√≥n `pivot_wider()`

Esta funci√≥n se utiliza para ordenar un dataframe de forma tal de mostrar 
categor√≠as de una variable como columnas de un dataframe.

--

Incrementa el n√∫mero de las columnas y disminuye el n√∫mero de las filas.

--

Es √∫til para la presentaci√≥n de cuadros de resumen con doble entrada.

--

```{r, eval=T, echo=FALSE}
library(tidyr)
ene %>%
  group_by(region, sexo) %>%
  summarise(n = n()) %>% 
  ungroup() %>% 
  slice(1:6) %>% 
  mutate(sexo = if_else(sexo == 1, "hombre", "mujer")) %>% 
  knitr::kable(format = "html")
```

---
background-image: url("imagenes/fondo2.PNG")
background-size: contain;
background-position: 100% 0%

# Tidy data

## Funci√≥n `pivot_wider()`

```{r, echo=F, fig.align = "center"}
library(tidyr)
ene %>%
  group_by(region, sexo) %>%
  summarise(n = n()) %>%
  mutate(sexo = if_else(sexo == 1, "hombre", "mujer")) %>% 
  pivot_wider(names_from = sexo,
              values_from = n) %>% 
  ungroup() %>% 
  slice(1:3) %>% 
  knitr::kable(format = "html")
```


### Ahora vemos las categor√≠as de sexo hacia la derecha

---
background-image: url("imagenes/fondo2.PNG")
background-size: contain;
background-position: 100% 0%

# Tidy data

## Funci√≥n `pivot_wider()`


```{r echo=FALSE, fig.align = "center"}
ene %>%
  group_by(sexo, est_conyugal) %>%
  summarise(n = n()) %>% 
  knitr::kable(format = "html")



```

---
background-image: url("imagenes/fondo2.PNG")
background-size: contain;
background-position: 100% 0%

# Tidy data

## Funci√≥n `pivot_wider()`


```{r echo=FALSE, fig.align = "center"}
ene %>% 
  group_by(sexo, est_conyugal) %>%
  summarise(n = n()) %>% 
  pivot_wider(names_from = est_conyugal, 
              values_from = n,
              names_prefix = "estado") %>% 
  knitr::kable(format = "html") 
  

```

### Pasamos de un formato largo a uno ancho



---

background-image: url("imagenes/fondo2.PNG")
background-size: contain;
background-position: 100% 0%

# Tidy data

## Funci√≥n `pivot_wider()`


```{r, eval=F}
ene %>%
  group_by(region, sexo) %>%
  summarise(n = n()) %>%
  mutate(sexo = if_else(sexo == 1, "hombre", "mujer")) %>% 
  pivot_wider(names_from = sexo, #<<
              values_from = n) #<<

```

- *names_from*: categor√≠as que se quiere convertir en columnas
- *values_from*: columna desde la cual extraer los valores

---

background-image: url("imagenes/fondo2.PNG")
background-size: contain;
background-position: 100% 0%

# Tidy data

En algunos casos, no contamos con una variable que contenga texto, para hacer el "pivoteo"

```{r, echo=F}
ene %>%
  group_by(region, sexo) %>%
  summarise(n = n())

```

--

En esos casos, podemos usar el par√°metro **names_prefix**

```{r, eval=FALSE}
ene %>%
  group_by(region, sexo) %>%
  summarise(n = n()) %>%
  pivot_wider(names_from = sexo,
              values_from = n,
              names_prefix = "sexo" ) #<<
```

---

background-image: url("imagenes/fondo2.PNG")
background-size: contain;
background-position: 100% 0%

# Tidy data

Efecto de incluir **names_prefix**

```{r, echo=FALSE}
ene %>%
  group_by(region, sexo) %>%
  summarise(n = n()) %>%
  pivot_wider(names_from = sexo,
              values_from = n,
              names_prefix = "sexo" ) 

```



---

background-image: url("imagenes/fondo2.PNG")
background-size: contain;
background-position: 100% 0%

# Tidy data

## Funci√≥n `pivot_longer()`

Esta funci√≥n se puede considerar como la opuesta a `pivot_wider()`.

--

Esta funci√≥n incrementa el n√∫mero de filas y disminuye el n√∫mero de columnas.

--

Los dataframes obtenidos por esta funci√≥n son m√°s f√°ciles de **manipular**, pero no de visualizar

--



--

Ejemplo de `pivot_longer()`:

--

```{r}
df1 <- data.frame(region = c(1, 2),
                  hombres = c(100, 200),
                  mujeres = c(50, 300))
df1
```



```{r,eval=F}
df1 %>%
  pivot_longer(cols = -region , names_to = "sexo", values_to = "total_sexo")
```

---

background-image: url("imagenes/fondo2.PNG")
background-size: contain;
background-position: 100% 0%

# Tidy data

## Funci√≥n `pivot_longer()`

```{r,echo=F}
df1 %>%
  pivot_longer(cols = -region , names_to = "sexo", values_to = "total_sexo")
```

Los argumentos m√°s comunes de esta funci√≥n son:

--

- *cols*: columnas a las que se le aplicar√° la operaci√≥n

--

- *names_to*: indica el nombre de la variable que ser√° creada para "guardar" los
nombres de las categor√≠as.


- *values_to*: indica el nombre de la variable que ser√° 
creada para "guardar" los valores asociados a las categor√≠as.

---

background-image: url("imagenes/fondo2.PNG")
background-size: contain;
background-position: 100% 0%

# Ejercicio express

Utilizando la base *ene*, calcule el n√∫mero de registros seg√∫n grupo 
ocupacional (b1), por mes (mes_encuesta).

Presente el resultado como un cuadro de resumen, con los grupos ocupacionales 
en las filas y los meses en las columnas.

---

background-image: url("imagenes/fondo2.PNG")
background-size: contain;
background-position: 100% 0%

# Ejercicio express

```{r}
ene %>%
  group_by(b1, mes_encuesta) %>%
  summarise(n = n()) %>%
  pivot_wider(names_from = mes_encuesta,
              names_prefix = "mes_",
              values_from = n)
```


---

background-image: url("imagenes/fondo2.PNG")
background-size: contain;
background-position: 100% 0%

# Ejercicios para la üè†

- Importar la base **ene-2019-11.csv**. 

- Cree las siguientes variables:

    - **pet**: que tome valor 1 si edad es mayor o igual a 15, y 0 en otro 
    caso.
    
    - **ocu**: que tome el valor 1 si la variable cae_especifico se encuentra 
    en el rango (extremos incluidos) entre 1 y 7, y que tome el valor 0 en 
    cualquier otro caso.
    
- Genere un cuadro de resumen agrupado por regi√≥n que muestre la suma de 
la variable **pet** y la suma de la variable **ocu**.

- Sobre el cuadro de resumen del punto anterior, cree la variable **tasa_ocup** por regi√≥n, 
usando la siguiente expresi√≥n: **total de ocu / total de pet X 100**

(De esta forma se obtiene la tasa de ocupaci√≥n, pero no ser√° equivalente a 
la oficial, pues no se est√°n considerando los factores de expansi√≥n).

- Usando las funciones de `tidyr`, genera un cuadro de resumen que muestre en las filas la categor√≠a de rama 
de actividad econ√≥mica (**b14_rev4cl_canes**) y en las columnas los grupos 
ocupacionales (**b1**).

---

background-image: url("imagenes/fondo2.PNG")
background-size: contain;
background-position: 100% 0%

# Referencias

Nada de esto ser√≠a posible sin:

- [`R fot Data Science, de Hadley Wickham`](https://r4ds.had.co.nz/)

- [`Advanced R, de Hadley Wickham`](http://adv-r.had.co.nz/Introduction.html)

- [`Data wrangling, exploration, and analysis with R, de Jenny Bryan`](https://stat545.com/index.html)

- [`Introduction to R, de Data Carpentry`](https://datacarpentry.org/R-genomics/01-intro-to-R.html#functions)

- [`Xaringan: Presentation Ninja, de Yihui Xie`](https://github.com/yihui/xaringan). Para generar esta presentaci√≥n con la planilla ninja ‚öî

R for Data Science tiene una traducci√≥n al espa√±ol realizada por la comunidad hisp
ana de R:

- [`R para ciencia de datos, de Hadley Wickham`](https://es.r4ds.hadley.nz/)

---

class: center, middle

.linea-superior[]
.linea-inferior[]

<img src="imagenes/logo_portada2.png" width="200" />

## Capacitaci√≥n en R y herramientas de productividad

## Proyecto Estrat√©gico Servicios Compartidos para la Producci√≥n Estad√≠stica

## Procesamiento de bases de datos (2)

### Mayo 2021
